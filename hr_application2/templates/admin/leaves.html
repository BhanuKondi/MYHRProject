{% extends "admin/admin_base.html" %}
{% block title %}Leave Management{% endblock %}

{% block content %}

<h2>Leave Management</h2>

<!-- TAB BUTTONS -->
<div class="d-flex mb-3">
    <button class="btn btn-primary me-2" onclick="showTab('holidays')">Holidays</button>
    <button class="btn btn-warning me-2" onclick="showTab('approvals')">Leave Approvals</button>
    <button class="btn btn-info" onclick="showTab('summary')">Employee Leave Details</button>
</div>

<!-- ========================= HOLIDAYS TAB ========================= -->
<div id="holidays" class="tab-content" style="display:none;">
    <h3>Holiday List</h3>

    <table class="table table-bordered mt-3">
        <thead>
            <tr>
                <th>Date</th>
                <th>Day</th>
                <th>Occasion</th>
            </tr>
        </thead>
        <tbody>
            {% for h in holidays %}
            <tr>
                <td>{{ h.date }}</td>
                <td>{{ h.day }}</td>
                <td>{{ h.occasion }}</td>
            </tr>
            {% else %}
            <tr>
                <td colspan="3" class="text-center text-muted">No holidays added</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- ====================== PENDING APPROVALS TAB ====================== -->
<div id="approvals" class="tab-content" style="display:none;">
    <h3>Pending Leave Approvals</h3>

    <table class="table table-bordered mt-3">
        <thead>
            <tr>
                <th>Employee</th>
                <th>Start</th>
                <th>End</th>
                <th>Total Days</th>
                <th>Reason</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody>
            {% for p in pending %}
            <tr>
                <td>{{ p.employee.first_name }} {{ p.employee.last_name }}</td>
                <td>{{ p.start_date }}</td>
                <td>{{ p.end_date }}</td>
                <td>{{ p.total_days }}</td>
                <td>{{ p.reason }}</td>
                <td>{{ p.status }}</td>
            </tr>
            {% else %}
            <tr>
                <td colspan="6" class="text-center text-muted">No pending requests</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- ========================= SUMMARY TAB ========================= -->
<div id="summary" class="tab-content" style="display:none;">
    <h3>Employee Leave Summary</h3>

    <table class="table table-bordered mt-3">
        <thead>
            <tr>
                <th>Employee</th>
                <th>Total Leaves</th>
                <th>Consumed</th>
                <th>Pending Balance</th>
            </tr>
        </thead>
        <tbody>
            {% for s in summaries %}
            <tr>
                <td>{{ s.employee.first_name }} {{ s.employee.last_name }}</td>
                <td>{{ s.total_leaves }}</td>
                <td>{{ s.consumed }}</td>
                <td>{{ s.pending }}</td>
            </tr>
            {% else %}
            <tr>
                <td colspan="4" class="text-center text-muted">No employee leave data</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- ========================= TAB SWITCH SCRIPT ========================= -->
<script>
function showTab(tabId) {
    document.querySelectorAll('.tab-content').forEach(function(section) {
        section.style.display = "none";
    });

    document.getElementById(tabId).style.display = "block";
}

// Show Holidays tab by default
window.onload = function() {
    showTab('holidays');
};
</script>

{% endblock %}